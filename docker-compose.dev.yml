version: '3'

services:

    front:
        build:
            context: ./front
            dockerfile: Dockerfile.dev
            args:
                - NODE_VERSION=${NODE_VERSION}
        volumes:
              - ./front/:/home/app
        command: "npm run dev"

    # front_admin:
    #     build:
    #         context: ./front_admin
    #         dockerfile: Dockerfile.dev
    #         args:
    #             - NODE_VERSION=${NODE_VERSION}
    #     volumes:
    #           - ./front_admin/:/home/app
    #     command: "npm run dev"

    # front_tax:
    #     build:
    #         context: ./front_tax
    #         dockerfile: Dockerfile.dev
    #         args:
    #             - NODE_VERSION=${NODE_VERSION}
    #     volumes:
    #           - ./front_tax/:/home/app
    #     command: "npm run dev"


    rabbitmq:
        env_file:
            - .dev.env

    redis:
        env_file:
            - .dev.env

    celery-worker:
        env_file:
            - .dev.env

    celery-beat:
        env_file:
            - .dev.env

    # flower:
    #     ports:
    #         - 8888:8888

    #     env_file:
    #         - .dev.env





    api:
        volumes:
              - ./api/app:/home/api/app
            #   - ./api/migrations/:/home/api/migrations
            #   - ./api/logs/:/home/logs
            #   - ./api/seeds:/home/seeds
        env_file:
            - .dev.env
        #command: bash -c "./wait-for-it.sh postgres:5433 --timeout=2 && flask run --host 0.0.0.0 --port 5005"



    postgres:
        # volumes:
        #     - pgdata_dev:/pgdata
        environment:
            - DATABASE=postgres
        ports:
            - 5433:5433
        env_file:
            - .dev.env

# volumes:
#     pgdata_dev:
